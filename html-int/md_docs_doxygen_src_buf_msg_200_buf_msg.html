<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MGE General C Library - Full Internal Documentation: Message Buffers and Messages</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MGE General C Library - Full Internal Documentation
   &#160;<span id="projectnumber">v1.8.4</span>
   </div>
   <div id="projectbrief">Library of general C functions.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_docs_doxygen_src_buf_msg_200_buf_msg.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Message Buffers and Messages </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#buffers_messages_overview">Overview</a></li>
<li class="level1"><a href="#buf">Buffers</a><ul><li class="level2"><a href="#concatbuf">concat_buf()</a></li>
<li class="level2"><a href="#trimbuf">trim_buf()</a></li>
</ul>
</li>
<li class="level1"><a href="#messages">Messages</a><ul><li class="level2"><a href="#msgfunctions">Functions</a><ul><li class="level3"><a href="#pullmsg">pull_msg()</a></li>
<li class="level3"><a href="#getmsg">get_msg()</a></li>
<li class="level3"><a href="#deconstructmsg">deconstruct_msg()</a></li>
<li class="level3"><a href="#clearmsg">clear_msg()</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="buffers_messages_overview"></a>
Overview</h1>
<p>These library functions address the need to exchange meassages, maybe between processes on the same machine, or, maybe between machines using UDP or TCP streams. The only fixed aspect of a message is that it contains 1 or more fields separated by a 'separator' charcter and terminated by a 'terminator' character. These 2 characters are defined in the <a class="el" href="structmgemessage.html">mgemessage struct</a>.</p>
<p>The data source for this system is a flat buffer which may contain part of a message, a complete message or mutiple messages.</p>
<p>This flat buffer is first loaded into a <a class="el" href="structmgebuffer.html">mgebuffer struct</a> which maintains a buffer and indexes to the next byte to be processed and the next free byte.</p>
<p>This <a class="el" href="structmgebuffer.html">mgebuffer struct</a> is then processed, extracting data into a <a class="el" href="structmgemessage.html">mgemessage struct</a> until it contains a complete message. When it contains a complete message it is parsed into individual arguments held in the struct.</p>
<div class="image">
<img src="buf-msg.png" alt=""/>
</div>
<h1><a class="anchor" id="buf"></a>
Buffers</h1>
<p>The buffers area consists of 2 functions; <a class="el" href="mge-buffer_8h.html#a84f0acd02cc1377f3fa2e3ac9c3b9ec2" title="Concatenate the used portion of a flat buffer into a buffer object.">concat_buf()</a> and <a class="el" href="mge-buffer_8h.html#adb167a2d1c26596ae70f35c495cf5286" title="Remove processed data from a buffer object if deemed necessary.">trim_buf()</a>.</p>
<h2><a class="anchor" id="concatbuf"></a>
concat_buf()</h2>
<p><a class="el" href="mge-buffer_8h.html#a84f0acd02cc1377f3fa2e3ac9c3b9ec2" title="Concatenate the used portion of a flat buffer into a buffer object.">concat_buf()</a> takes the supplied flat buffer and appends it to the buffer in the supplied <a class="el" href="structmgebuffer.html">mgebuffer struct</a> updating the relevant pointers.</p>
<h2><a class="anchor" id="trimbuf"></a>
trim_buf()</h2>
<p>The <a class="el" href="mge-buffer_8h.html#adb167a2d1c26596ae70f35c495cf5286" title="Remove processed data from a buffer object if deemed necessary.">trim_buf()</a> function removes processed data from the <a class="el" href="structmgebuffer.html">mgebuffer struct</a> buffer. It is typically called after some or all of the data in the <a class="el" href="structmgebuffer.html">mgebuffer struct</a> has been processed, often after <a class="el" href="message_8c.html#aa12f32bb998a72d957336b93491e1cac" title="Get a message from a buffer object.">get_msg()</a> has extracted data to a <a class="el" href="structmgemessage.html">mgemessage struct</a>.</p>
<h1><a class="anchor" id="messages"></a>
Messages</h1>
<p>The message area API consists of 2 functions; <a class="el" href="mge-message_8h.html#a41d33ae7dacfcac0c7853faeadab7558" title="Pull a message from a buffer object.">pull_msg()</a> and <a class="el" href="mge-message_8h.html#a0540546fe564b51dbccd55ba0f86ea2f" title="Clear message struct.">clear_msg()</a>. Behind the scenes <a class="el" href="message_8c.html#aa12f32bb998a72d957336b93491e1cac" title="Get a message from a buffer object.">get_msg()</a> and <a class="el" href="message_8c.html#a2125d2bf942ec7739238ca700879935c" title="Deconstruct a complete message to its individual elements.">deconstruct_msg()</a> are called from <a class="el" href="mge-message_8h.html#a41d33ae7dacfcac0c7853faeadab7558" title="Pull a message from a buffer object.">pull_msg()</a>.</p>
<p>The following diagram shows a typical message workflow.</p>
<div class="image">
<img src="msg-flow.png" alt=""/>
</div>
<h2><a class="anchor" id="msgfunctions"></a>
Functions</h2>
<h3><a class="anchor" id="pullmsg"></a>
pull_msg()</h3>
<p>The <a class="el" href="mge-message_8h.html#a41d33ae7dacfcac0c7853faeadab7558" title="Pull a message from a buffer object.">pull_msg()</a> function extracts data from the <a class="el" href="structmgebuffer.html">mgebuffer struct</a> buffer and loads it into a <a class="el" href="structmgemessage.html">mgemessage struct</a>. The processed part of the <a class="el" href="structmgebuffer.html">mgebuffer struct</a> buffer is then removed by invoking <a class="el" href="mge-buffer_8h.html#adb167a2d1c26596ae70f35c495cf5286" title="Remove processed data from a buffer object if deemed necessary.">trim_buf()</a>. If the <a class="el" href="structmgemessage.html">mgemessage struct</a> buffer then holds a complete message it is deconstructed and fully populates the <a class="el" href="structmgemessage.html">mgemessage struct</a>.</p>
<div class="image">
<img src="pull-msg-flow.png" alt=""/>
</div>
<p>The same diagram with function names.</p>
<div class="image">
<img src="pull-msg-flow-int.png" alt=""/>
</div>
<h3><a class="anchor" id="getmsg"></a>
get_msg()</h3>
<p>The <a class="el" href="message_8c.html#aa12f32bb998a72d957336b93491e1cac" title="Get a message from a buffer object.">get_msg()</a> function extracts data, (partial or complete messages), from the <a class="el" href="structmgebuffer.html">mgebuffer struct</a> buffer and loads them into a <a class="el" href="structmgemessage.html">mgemessage struct</a>. </p><div class="image">
<img src="get-msg-flow.png" alt=""/>
</div>
<h3><a class="anchor" id="deconstructmsg"></a>
deconstruct_msg()</h3>
<p>The <a class="el" href="message_8c.html#a2125d2bf942ec7739238ca700879935c" title="Deconstruct a complete message to its individual elements.">deconstruct_msg()</a> function is invoked by the <a class="el" href="mge-message_8h.html#a41d33ae7dacfcac0c7853faeadab7558" title="Pull a message from a buffer object.">pull_msg()</a> function when the <a class="el" href="structmgemessage.html">mgemessage struct</a> buffer contains a complete message. This function then parses the message into it's individual fields and places them in argv updating argc. (argc and argv have the same function and format as in the standard C main function).</p>
<h3><a class="anchor" id="clearmsg"></a>
clear_msg()</h3>
<p>The <a class="el" href="mge-message_8h.html#a0540546fe564b51dbccd55ba0f86ea2f" title="Clear message struct.">clear_msg()</a> function frees the message buffer and argument storage and resets the other fileds to initial values. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
